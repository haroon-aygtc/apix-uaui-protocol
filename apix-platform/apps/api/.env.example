# Application
NODE_ENV=development
PORT=3000

# Database (PostgreSQL)
DATABASE_URL=postgresql://postgres:password@localhost:5432/apix_db
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=password
DB_NAME=apix_db
DB_SSL=false
DB_MAX_CONNECTIONS=100
DB_ACQUIRE_TIMEOUT=60000
DB_TIMEOUT=60000
DB_RETRY_ATTEMPTS=3
DB_RETRY_DELAY=3000

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=apix:
REDIS_RETRY_DELAY=100
REDIS_MAX_RETRIES=3

# Redis Cluster (optional)
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=

# Redis Streams
REDIS_STREAM_MAX_LENGTH=10000
REDIS_CONSUMER_GROUP=apix-consumers
REDIS_CONSUMER_NAME=apix-consumer-1
REDIS_STREAM_BLOCK_TIME=5000
REDIS_STREAM_COUNT=10

# Authentication
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=24h
JWT_ISSUER=apix-backend
JWT_AUDIENCE=apix-clients
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-in-production
JWT_REFRESH_EXPIRES_IN=7d
BCRYPT_SALT_ROUNDS=12

# Session
SESSION_MAX_AGE=86400000

# Rate Limiting
AUTH_RATE_LIMIT_WINDOW=900000
AUTH_RATE_LIMIT_MAX=5
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=60000

# WebSocket
WS_PORT=3001
WS_PATH=/ws
WS_CORS_ORIGIN=http://localhost:3000
WS_COMPRESSION=true
WS_MAX_PAYLOAD_LENGTH=16777216
WS_IDLE_TIMEOUT=120
WS_MAX_CONNECTIONS=10000

# WebSocket Heartbeat
WS_HEARTBEAT_INTERVAL=30000
WS_HEARTBEAT_TIMEOUT=60000

# WebSocket Rate Limiting
WS_RATE_LIMIT_WINDOW=60000
WS_RATE_LIMIT_MAX=100

# WebSocket Channels
WS_MAX_SUBSCRIPTIONS=50
WS_CHANNEL_TTL=3600000

# WebSocket Retry
WS_RETRY_MAX_ATTEMPTS=3
WS_RETRY_BACKOFF_MULTIPLIER=2
WS_RETRY_INITIAL_DELAY=1000
WS_RETRY_MAX_DELAY=30000

# CORS
CORS_ORIGIN=http://localhost:3000

# =============================================================================
# RBAC & AUTHENTICATION SECURITY
# =============================================================================
# Tenant-specific Rate Limiting
TENANT_RATE_LIMIT=true
TENANT_RATE_WINDOW=60000
TENANT_RATE_MAX_REQUESTS=100
TENANT_RATE_SKIP_SUCCESS=false
TENANT_RATE_PER_USER=true
TENANT_RATE_PER_ENDPOINT=true

# Tenant Isolation & Security
TENANT_CROSS_VALIDATION=true
TENANT_OWNERSHIP_CHECK=true
TENANT_PERMISSION_CACHE=true
TENANT_PERMISSION_CACHE_TTL=300
TENANT_SECURITY_ALERTS=true
TENANT_MAX_FAILED_ATTEMPTS=5
TENANT_LOCKOUT_DURATION=900

# Session Configuration
SESSION_SECURE=false
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# Audit & Logging
AUDIT_ENABLE_DATABASE_STORAGE=true
AUDIT_ENABLE_REAL_TIME_ALERTS=true
AUDIT_RETENTION_DAYS=90
AUDIT_ENABLE_COMPLIANCE_REPORTS=true

# Feature Flags
ENABLE_RBAC=true
ENABLE_MULTI_TENANT=true
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMITING=true
ENABLE_WEBSOCKET_SECURITY=true
